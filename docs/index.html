<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <title>Таблица для доски</title>
    <style>
      html,
      body {
        margin: 0;
        padding: 0;
        height: 100%;
        width: 100%;
        overflow: auto;
        font-family: Arial, sans-serif;
        background: #f4f4f4;
      }
      #tableWrapper {
        width: 100%;
        height: 100%;
        overflow: auto;
      }
      table {
        border-collapse: collapse;
        width: 100%;
        min-width: 800px;
        font-size: 16px;
        transform-origin: top left;
      }
      th {
        background-color: #4caf50;
        color: white;
        position: sticky;
        top: 0;
        padding: 8px;
      }
      td {
        border: 1px solid #ddd;
        padding: 8px;
      }
      tr:nth-child(even) {
        background-color: #f2f2f2;
      }
      tr:hover {
        background-color: #ddd;
      }
    </style>
  </head>
  <body>
    <div id="tableWrapper">
      <table id="dataTable"></table>
    </div>

    <script>
      const tableWrapper = document.getElementById("tableWrapper");
      const table = document.getElementById("dataTable");

      // Функция для обновления таблицы
      function updateTable() {
        google.script.run.withSuccessHandler(renderTable).getSheetData();
      }

      // Отображаем данные в таблице
      function renderTable(data) {
        table.innerHTML = "";
        if (!data || data.length === 0) return;

        const headerRow = document.createElement("tr");
        data[0].forEach((h) => {
          const th = document.createElement("th");
          th.textContent = h;
          headerRow.appendChild(th);
        });
        table.appendChild(headerRow);

        for (let r = 1; r < data.length; r++) {
          const tr = document.createElement("tr");
          for (let c = 0; c < data[r].length; c++) {
            const td = document.createElement("td");
            td.textContent = data[r][c];
            tr.appendChild(td);
          }
          table.appendChild(tr);
        }

        autoScale();
      }

      // Функция автоматического масштабирования таблицы под экран
      function autoScale() {
        const wrapperWidth = tableWrapper.clientWidth;
        const wrapperHeight = tableWrapper.clientHeight;
        const tableWidth = table.offsetWidth;
        const tableHeight = table.offsetHeight;

        const scaleX = wrapperWidth / tableWidth;
        const scaleY = wrapperHeight / tableHeight;
        const scale = Math.min(scaleX, scaleY, 1); // не увеличиваем больше 100%
        table.style.transform = "scale(" + scale + ")";
      }

      // Первоначальная загрузка
      updateTable();

      // Обновление каждые 30 секунд
      setInterval(updateTable, 30000);

      // Подстройка при изменении размера окна
      window.addEventListener("resize", autoScale);
    </script>
  </body>
</html>
